<?php

namespace Bin\Controllers\Web;

use Snake\Core\Http\Request;
use Bin\Controllers\Controller;

class AssetController extends Controller {
  /**
   * Display a listing of the resource.
   *
   * @return void
   */
  public function index() {
    // Show all images in the images folder
    // Get all files in the images folder
    $files = scandir(PUBLIC_PATH . '/images');

    // Remove . and .. from the files
    $files = array_diff($files, ['.', '..']);

    // Return the view with the files
    return static::view('pages.admin.asset.index', [
      'files' => $files
    ]);
  }

  /**
   * Display specified resource.
   *
   * @return void
   */
  public function show(Request $request) {
    // Get the file name from the request
    $file = $request->get('name');

    $path = PUBLIC_PATH . '/images/' . $file;

    // Get file path from the images folder
    // using shell_exec to prevent directory traversal
    $file = shell_exec('cat ' . $path);

    // Return the view with the file
    return static::view('pages.admin.asset.show', [
      'file' => $file
    ]);
  }
}
