<?= $this->extend('layouts.dashboard', ['title' => 'Pengguna']) ?>

<?= $this->append('css') ?>
  <link rel="stylesheet" href="<?= asset('css/dashboard-custom.css') ?>">
<?= $this->stop() ?>

<?= $this->section('sidebar') ?>
  <?php if (session()->exists('user') && session()->get('user')['role'] == 'admin'): ?>
    <?= $this->put('partials.sidebar.admin') ?>
  <?php else: ?>
    <?= $this->put('partials.sidebar.user') ?>
  <?php endif; ?>
<?= $this->stop() ?>

<?= $this->section('content') ?>
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="greet">Tambah Catatan</h1>
    <div>
      <a href="<?= route('admin.user.index') ?>" class="btn btn-primary">Back</a>
    </div>
  </div>

  <form action="<?= route('admin.user.store') ?>" method="post">
    <div class="mb-3">
      <label for="name" class="form-label"><?= $get('formTitle', 'Name') ?></label>
      <input type="text" class="form-control" id="name" name="name" placeholder="Your <?= $get('formTitle', 'Name') ?>" value="<?= input_old('name') ?>">
    </div>

    <?php if ($get('error_form') && array_key_exists('name', $get('error_form'))): ?>
      <div class="alert alert-danger" role="alert">
      <?= $get('error_form')['name'] ?>
      </div>
    <?php endif; ?>

    <div class="mb-3">
      <label for="username" class="form-label"><?= $get('formTitle', 'Username') ?></label>
      <input type="text" class="form-control" id="username" name="username" placeholder="Your <?= $get('formTitle', 'Username') ?>" value="<?= input_old('username') ?>">
    </div>

    <?php if ($get('error_form') && array_key_exists('username', $get('error_form'))): ?>
      <div class="alert alert-danger" role="alert">
      <?= $get('error_form')['username'] ?>
      </div>
    <?php endif; ?>

    <div class="mb-3">
      <label for="role" class="form-label"><?= $get('formTitle', 'Role') ?></label>
      <select class="form-select" id="role" name="role">
        <option value="" disabled selected>Pilih Role...</option>
        <option value="ADMIN" <?= input_old('role') == 'ADMIN' ? 'selected' : '' ?>>Admin</option>
        <option value="USER" <?= input_old('role') == 'USER' ? 'selected' : '' ?>>User</option>
      </select>
    </div>

    <?php if ($get('error_form') && array_key_exists('role', $get('error_form'))): ?>
      <div class="alert alert-danger" role="alert">
      <?= $get('error_form')['role'] ?>
      </div>
    <?php endif; ?>

    <div class="mb-3">
      <label for="password" class="form-label">Password</label>
      <input type="password" class="form-control" id="password" name="password" placeholder="Your Password" value="<?= input_old('password') ?>">
    </div>

    <?php if ($get('error_form') && array_key_exists('password', $get('error_form'))): ?>
      <div class="alert alert-danger" role="alert">
      <?= $get('error_form')['password'] ?>
      </div>
    <?php endif; ?>

    <div class="mb-3">
      <label for="password_confirmation" class="form-label">Konfirmasi Password</label>
      <input type="password" class="form-control" id="password_confirmation" name="password_confirmation" placeholder="Your Confirmation Password" value="<?= input_old('password_confirmation') ?>">
    </div>

    <?php if ($get('error_form') && array_key_exists('password_confirmation', $get('error_form'))): ?>
      <div class="alert alert-danger" role="alert">
      <?= $get('error_form')['password_confirmation'] ?>
      </div>
    <?php endif; ?>

    <?php if ($get('error')): ?>
      <div class="alert alert-danger mb-3" role="alert">
        <?= $get('error') ?>
      </div>
    <?php endif; ?>

    <?php if ($get('bypass')): ?>
      <div class="mb-3">
        <?= $this->put('partials.card.flag', ['flag_title' => 'bypass_authorization', 'flag_key' => 'flag{this is bypass authorization key}']) ?>
      </div>
    <?php endif; ?>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
<?= $this->stop() ?>
