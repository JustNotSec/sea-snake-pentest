<?= $this->extend('layouts.dashboard', ['title' => 'Dashboard']) ?>

<?= $this->append('css') ?>
  <link rel="stylesheet" href="<?= asset('css/dashboard-custom.css') ?>">
<?= $this->stop() ?>

<?= $this->section('sidebar') ?>
  <?php if (session()->exists('user') && session()->get('user')['role'] == 'admin'): ?>
    <?= $this->put('partials.sidebar.admin') ?>
  <?php else: ?>
    <?= $this->put('partials.sidebar.user') ?>
  <?php endif; ?>
<?= $this->stop() ?>

<?= $this->section('content') ?>
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="greet">Hello, <?= $get('username') ?></h1>
  </div>

  <div class="container">
    <div class="row">
      <div class="col">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Selamat Datang</h5>
            <p class="card-text">Selamat datang di halaman dashboard, <?= $get('username') ?>. Semoga harimu menyenangkan <?= $get('flag') ? "dan semangat hacking!" : "dan catat keseharian mu" ?></p>
          </div>
        </div>

        <?php if ($get('flag')): ?>
          <br/>
          <?= $this->put('partials.card.flag', ['flag_title' => 'bypass_authentication', 'flag_key' => 'flag{this is bypass authentication key}']) ?>
        <?php endif; ?>

        <?php if ($get('notes') || !empty($get('notes'))): ?>
          <br/>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Catatan</h5>
              <p class="card-text">Berikut adalah catatan yang telah kamu buat</p>
              <ul class="list-group">
                <?php foreach ($get('notes') as $note): ?>
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    <?= $note['title'] ?>
                    <span class="badge bg-primary rounded-pill"><?= $note['content'] ?></span>
                  </li>
                <?php endforeach; ?>
            </div>
          </div>
        <?php else: ?>
          <br/>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Catatan</h5>
              <p class="card-text">Kamu belum membuat catatan apapun</p>
            </div>
          </div>
        <?php endif; ?>
      </div>
    </div>
  </div>
<?= $this->stop() ?>
