<?= $this->extend('layouts.dashboard', ['title' => 'Dashboard']) ?>

<?= $this->append('css') ?>
  <link rel="stylesheet" href="<?= asset('css/dashboard-custom.css') ?>">
<?= $this->stop() ?>

<?= $this->section('sidebar') ?>
  <ul class="nav flex-column">
    <li class="nav-item">
      <a class="nav-link" aria-current="page" href="<?= route('admin.dashboard.index') ?>">
        <span data-feather="home" class="align-text-bottom"></span>
        Dashboard
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" aria-current="page" href="<?= route('admin.kelas.index') ?>">
        <span data-feather="home" class="align-text-bottom"></span>
        Kelas
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" aria-current="page" href="<?= route('admin.asset.index') ?>">
        <span data-feather="home" class="align-text-bottom"></span>
        Asset
      </a>
    </li>
  </ul>
<?= $this->stop() ?>

<?= $this->section('content') ?>
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="greet">Hello, <?= $get('username') ?></h1>
    <div>
      <a href="<?= route('admin.kelas.create') ?>" class="btn btn-primary">Tambah</a>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th>#</th>
          <th>Nama Kelas</th>
          <th>Deskripsi</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <?php foreach ($get('data') as $key => $class): ?>
          <tr>
            <td><?= $key + 1 ?></td>
            <td><?= $class['name'] ?></td>
            <td><?= $class['description'] ?></td>
            <td>
              <a href="<?= route('admin.kelas.show') ?>?id=<?= $class['id'] ?>" class="btn btn-warning">Ubah</a>

              <form action="<?= route('admin.kelas.index') ?>" method="get" class="d-inline">
                <button type="submit" onclick="confirmDelete(<?= $class['id'] ?>)" class="btn btn-danger">Hapus</button>
              </form>
            </td>
          </tr>
        <?php endforeach; ?>
      </tbody>
    </table>
  </div>
<?= $this->stop() ?>

<?= $this->append('script') ?>
  <script>
    function confirmDelete(id) {
      const confirm = window.confirm('Apakah anda yakin ingin menghapus data ini?');

      if (confirm) {
        fetch(`<?= route('admin.kelas.delete') ?>?id=${id}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          }
        })
      }
    }
  </script>
<?= $this->stop() ?>

